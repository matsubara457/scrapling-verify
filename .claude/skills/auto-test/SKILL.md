---
name: auto-test
description: service/repositoryのロジック変更後にテスト不足を自動検出し、テストケースを提案または自動作成する。ロジック変更後に自動発火。
---

## 発火条件（必ず守る）
以下を Edit した直後に自動発火:
- `backend/src/services/*.ts`（ビジネスロジック変更）
- `backend/src/repositories/*.ts`（クエリロジック変更）

## 手順（15秒以内）
1. 変更した関数/メソッドを特定
2. 対応するテストファイルを検索: `backend/src/__tests__/**/*<entity>*`
3. 判定:

| 状況 | アクション |
|---|---|
| テストファイルなし | `⚠️ auto-test: [entity] のテストが未作成。作成しますか？` |
| テストあるが変更関数のテストなし | `⚠️ auto-test: [method] のテストケースが不足` |
| テストあり＆カバーされている | 無言（報告しない） |

4. ユーザーが「作って」と言ったら → テスト規約（vi.mock, 日本語テスト名）に従い即作成
5. ユーザーが何も言わなかったら → そのまま作業続行
