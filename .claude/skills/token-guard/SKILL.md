---
name: token-guard
description: トークン消費を常時抑制しつつ出力品質を維持する行動ルール。全会話で常時適用。
---

## 常時適用ルール（全応答で守る）

### 入力最適化
- **Grep/Glob先行**: Read する前に必ず Grep/Glob で対象を絞る。全文Read は最終手段
- **重複読み禁止**: 同一セッションで同じファイルを2回 Read しない
- **部分読み**: 大ファイル(200行超)は offset/limit で必要部分のみ Read
- **Explore委譲**: 3ファイル超の探索は Task(Explore) に1回で委譲

### 出力最適化
- **表 > 長文**: 比較・一覧は必ずテーブル形式
- **コード内コメント最小**: 自明なコードにコメント不要
- **報告は1行**: 自動発火スキルの報告は問題時のみ1行。正常時は無言
- **並列実行**: 独立した操作は必ず並列（Bash, Read, Grep を同時呼び出し）

### サブエージェント最適化
- **background活用**: 結果を待たなくてよい調査は `run_in_background: true`
- **model指定**: 調査=haiku, 分析=sonnet, 実装=inherit で最小コスト
- **独立タスクは並列**: 複数の Task 呼び出しは1メッセージで同時発行
