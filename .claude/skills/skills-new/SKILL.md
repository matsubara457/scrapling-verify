---
name: skills-new
description: 新しいClaude Code Skillを設計・作成する（自己批判ループで品質保証）
argument-hint: "[スキル名 or やりたいことの説明]"
disable-model-invocation: true
---

## 手順

### 1. 要件把握
`$ARGUMENTS` から目的を把握。引数なし → ユーザーに目的を確認。
明確にすべき: 目的、引数、必要ツール

### 2. 既存スキル確認
`.claude/skills/` で重複・参考パターンを確認
- 重複あり → 既存スキルの拡張を提案（新規作成しない）
- 類似あり → 構造・報告形式を参考にして一貫性を保つ

### 3. 設計原則
- 破壊的操作 → `disable-model-invocation: true` + `allowed-tools` 最小権限
- 読み取り専用 → `disable-model-invocation: false` 可
- 手順は番号付き、曖昧さ排除
- CLAUDE.mdと重複する情報は書かない
- 結果報告は構造化フォーマット（`=====` 区切り）で定義

### 4. ファイル作成
`.claude/skills/<name>/` ディレクトリを作成し、`SKILL.md` を書き込む

### 5. 自己批判ループ（2回転）
作成したSKILL.mdを**Readツールでディスクから再読み込み**し、以下の観点で批判→即修正。**2回繰り返す。**
問題がなければ途中終了してよい。

**批判観点:**
1. **安全性** — 破壊的操作の保護、allowed-tools最小権限
2. **エッジケース** — 引数なし/無効入力/中断時の後始末
3. **パス問題** — `cd`依存排除、`-C`フラグ/絶対パス使用、Bash毎回新シェル前提
4. **トークン効率** — 冗長排除、CLAUDE.md重複排除
5. **失敗モード** — 失敗箇所の特定、リカバリー手順、リトライ上限
6. **一貫性** — 他スキルとの構造・命名・報告形式の統一
7. **既存スキルとの責務境界** — 特に /done, /check, /review, /pre-push との重複・矛盾
8. **実行効率** — 二重実行、不要なステップ、スキップ可能な処理

**ルール:**
- 批判で「正しく動いている部分」を壊さない。追加・修正のみ。
- 修正前後で意味が変わる場合は修正しない。
- 各ラウンドの結果をテーブルで表示: `| # | 問題 | 深刻度 | 対応 |`

### 6. 報告
```
===== /<name> created =====
目的:     [1行]
引数:     [形式]
批判改善: [改善した点 or なし]
===========================
```
